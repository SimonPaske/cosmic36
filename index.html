<!doctype html>
<html lang="en" data-layout="mobile">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cosmic 36 — Today</title>

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest" />
  <meta name="theme-color" content="#0b0b0f" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Cosmic 36">
  <link rel="apple-touch-icon" href="./icons/icon-192.png">

  <link rel="stylesheet" href="./assets/style.css" />
</head>

<body>
  <div class="aura" aria-hidden="true"></div>

  <header class="container appHeader">
    <div class="brand">
      <h1>Cosmic 36 — Today</h1>
      <p id="subLine">One screen. One day. One note.</p>
    </div>

    <nav class="headerActions" aria-label="App actions">
      <button class="topBtn" id="layoutBtn" type="button">Desktop view</button>

      <button class="topBtn" id="openSettings" type="button" aria-haspopup="dialog" aria-expanded="false"
        aria-controls="settingsDialog">
        Settings
      </button>
    </nav>
  </header>

  <main class="container">
    <article class="card" aria-label="Today overview">
      <header class="cardHeader">
        <h2 id="headerTitle">Day — / 36</h2>
        <p id="headerPhase">Open Settings and enter your date of birth.</p>
        <div class="chips" id="chipRow" aria-label="Today badges"></div>
      </header>

      <div class="cardBody">
        <div class="layout">
          <!-- Main column -->
          <section aria-label="Today guidance and note">
            <section class="today light" id="todayCard" aria-label="Today guidance">
              <header class="todayTop">
                <h3 id="bigDay">Day — <small>/ 36</small></h3>

                <button class="stateBtn" id="statusBtn" type="button" aria-pressed="false">
                  <span class="stateDot" id="stateDot" aria-hidden="true"></span>
                  <span id="statusText">Not marked</span>
                </button>
              </header>

              <p class="guidance" id="guidanceLine">—</p>
              <p class="hint" id="hintLine">—</p>

              <aside class="insight" id="insightBox" aria-label="Spiritual insight" hidden>
                <h4>Spiritual insight for today</h4>
                <p id="insightLine">—</p>
              </aside>

              <p class="swipeHint" id="swipeHint">
                <span><b>Swipe right</b> to mark</span>
                <span><b>Swipe left</b> to unmark</span>
              </p>
            </section>

            <hr class="sep" />

            <section aria-label="Daily note">
              <label class="noteLabel" for="noteBox" id="notePrompt">Note</label>
              <textarea id="noteBox" placeholder="Write one honest line."></textarea>

              <div class="noteFooter">
                <div class="live" id="saveStatus" aria-live="polite">
                  <span class="mark" aria-hidden="true"></span>
                  <span id="saveText">Autosave enabled</span>
                </div>

                <div class="controls">
                  <button class="btn" id="clearNoteBtn" type="button">Clear note</button>
                </div>
              </div>
            </section>
          </section>

          <!-- Desktop aside -->
          <aside class="asideCard" id="lifeAside" aria-label="Life snapshot" hidden>
            <h2>Life on Earth</h2>
            <p id="asideText">—</p>
            <div class="kv" id="kv"></div>
          </aside>
        </div>
      </div>
    </article>
  </main>

  <footer class="container" style="margin-top: 12px; font-size:12px; color: var(--muted);">
    <span id="copyrightLine">© <span id="yearNow"></span> Cosmic 36. All rights reserved.</span>
  </footer>

  <!-- Settings dialog -->
  <dialog id="settingsDialog" aria-labelledby="settingsTitle">
    <div class="dialogHead">
      <h2 id="settingsTitle">Settings</h2>
      <button class="topBtn" id="closeSettings" type="button">Close</button>
    </div>

    <div class="dialogBody">
      <div class="field">
        <label for="dob">Date of birth</label>
        <input type="date" id="dob" />
      </div>

      <div class="field">
        <label>Day boundary mode</label>
        <div class="radioRow">
          <label><input type="radio" name="mode" value="utc" checked> UTC-safe</label>
          <label><input type="radio" name="mode" value="local"> Local midnight</label>
        </div>
      </div>

      <div class="field">
        <label for="density">Guidance density</label>
        <select id="density">
          <option value="minimal">Minimal</option>
          <option value="supportive">Supportive</option>
          <option value="silent">Silent</option>
        </select>
      </div>

      <div class="field">
        <label>Gentle continuity</label>
        <div class="radioRow">
          <label><input type="radio" name="gentle" value="on" checked> On (Not marked)</label>
          <label><input type="radio" name="gentle" value="off"> Off (Not done)</label>
        </div>
      </div>

      <div class="field">
        <button class="btn" id="clearCycleBtn" type="button">Clear current cycle data</button>
      </div>
    </div>
  </dialog>

  <div class="toast" id="toast" role="status" aria-live="polite">Saved</div>

  <script src="./assets/app.js" defer></script>

  <script>
    // Register SW (small inline only)
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./service-worker.js").catch(() => { });
      });
    }
  </script>
</body>

</html>