<!-- index.html — FULL FILE (matches the app.js above) -->
<!doctype html>
<html lang="en" data-layout="mobile" data-experience="compact">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cosmic 36 — Today</title>

  <link rel="manifest" href="./manifest.webmanifest" />
  <meta name="theme-color" content="#0b0b0f" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Cosmic 36">
  <link rel="apple-touch-icon" href="./icons/icon-192.png">

  <link rel="stylesheet" href="./assets/style.css" />
</head>

<body>
  <div class="aura" aria-hidden="true"></div>

  <header class="container appHeader">
    <div class="brand">
      <h1>Cosmic 36 — Today</h1>
      <p id="subLine">One screen. One day. One note.</p>
    </div>

    <nav class="headerActions" aria-label="App actions">
      <button class="topBtn" id="layoutBtn" type="button">Desktop view</button>

      <button class="topBtn" id="openReview" type="button" aria-haspopup="dialog" aria-expanded="false"
        aria-controls="reviewDialog">
        Review
      </button>

      <button class="topBtn" id="openSettings" type="button" aria-haspopup="dialog" aria-expanded="false"
        aria-controls="settingsDialog">
        Settings
      </button>
    </nav>
  </header>

  <main class="container">
    <article class="card" aria-label="Today overview">
      <header class="cardHeader">
        <h2 id="headerTitle">Day — / 36</h2>
        <p id="headerPhase">Open Settings and enter your date of birth.</p>
        <div class="chips" id="chipRow" aria-label="Today badges"></div>
        <p class="microLine" id="patternLine" aria-live="polite"></p>
      </header>

      <div class="cardBody">
        <div class="layout">
          <section aria-label="Main column">

            <section class="today light" id="todayCard" aria-label="Today guidance">
              <header class="todayTop">
                <h3 id="bigDay">Day — <small>/ 36</small></h3>

                <button class="stateBtn" id="statusBtn" type="button" aria-pressed="false">
                  <span class="stateDot" id="stateDot" aria-hidden="true"></span>
                  <span id="statusText">Not marked</span>
                </button>
              </header>

              <p class="guidance" id="guidanceLine">—</p>
              <p class="hint" id="hintLine">—</p>

              <aside class="insight" id="insightBox" aria-label="Spiritual insight" hidden>
                <h4>Spiritual insight for today</h4>
                <p id="insightLine">—</p>
                <p class="micro">Written inside the app. Offline.</p>
              </aside>

              <p class="swipeHint" id="swipeHint">
                <span><b>Swipe right</b> to mark</span>
                <span><b>Swipe left</b> to unmark</span>
              </p>
            </section>

            <hr class="sep" />

            <section aria-label="Daily note">
              <label class="noteLabel" for="noteBox" id="notePrompt">Mindful note</label>
              <textarea id="noteBox" rows="6"
                placeholder="What did I do? What did I notice? What will I carry forward?"></textarea>

              <div class="noteFooter">
                <div class="live" id="saveStatus" aria-live="polite">
                  <span class="mark" aria-hidden="true"></span>
                  <span id="saveText">Autosave enabled</span>
                </div>

                <div class="controls">
                  <button class="btn" id="expandBtn" type="button" aria-expanded="false"
                    aria-controls="noteBox">Expand</button>
                  <button class="btn" id="insertTemplateBtn" type="button">Insert template</button>
                  <button class="btn" id="clearNoteBtn" type="button">Clear</button>
                </div>
              </div>
            </section>

            <section id="extrasWrap" aria-label="Extra sections">
              <hr class="sep" />

              <details class="panel" id="intentionPanel">
                <summary>Intention (morning)</summary>
                <textarea id="intentionBox" rows="4"
                  placeholder="One clear sentence: what will I repeat + embody today?"></textarea>
                <div class="noteFooter">
                  <div class="live" aria-live="polite">
                    <span class="mark" aria-hidden="true"></span>
                    <span class="mini" id="intentionSaveText">Autosave enabled</span>
                  </div>
                </div>
              </details>

              <details class="panel" id="reflectionPanel">
                <summary>Reflection (evening)</summary>
                <textarea id="reflectionBox" rows="5"
                  placeholder="What returned? What did I notice? What does it mean?"></textarea>
                <div class="noteFooter">
                  <div class="live" aria-live="polite">
                    <span class="mark" aria-hidden="true"></span>
                    <span class="mini" id="reflectionSaveText">Autosave enabled</span>
                  </div>
                </div>
              </details>

              <details class="panel" id="closeCyclePanel">
                <summary>Close the cycle (Day 36)</summary>
                <p class="micro">Only relevant on Day 36 — but you can write anytime.</p>

                <label class="noteLabel" for="cycleLessonBox">What did this cycle teach me?</label>
                <textarea id="cycleLessonBox" rows="3" placeholder="One honest lesson…"></textarea>

                <label class="noteLabel" for="cycleCarryBox">What stays (what I carry forward)?</label>
                <textarea id="cycleCarryBox" rows="3" placeholder="One commitment…"></textarea>

                <label class="noteLabel" for="cycleReleaseBox">What leaves (what I release)?</label>
                <textarea id="cycleReleaseBox" rows="3" placeholder="One thing I stop feeding…"></textarea>

                <div class="noteFooter">
                  <div class="live" aria-live="polite">
                    <span class="mark" aria-hidden="true"></span>
                    <span class="mini" id="cycleSaveText">Autosave enabled</span>
                  </div>

                  <div class="controls">
                    <button class="btn" id="exportCycleBtn" type="button">Export cycle (TXT)</button>
                  </div>
                </div>
              </details>
            </section>

          </section>

          <aside class="asideCard" id="lifeAside" aria-label="Life snapshot" hidden>
            <h2>Life on Earth</h2>
            <p id="asideText">—</p>
            <div class="kv" id="kv"></div>
          </aside>
        </div>
      </div>
    </article>
  </main>

  <footer class="container footer">
    © <span id="yearNow"></span> Simon Paske. All rights reserved.
  </footer>

  <!-- Settings dialog -->
  <dialog id="settingsDialog" aria-labelledby="settingsTitle">
    <div class="dialogHead">
      <h2 id="settingsTitle">Settings</h2>
      <button class="topBtn" id="closeSettings" type="button">Close</button>
    </div>

    <div class="dialogBody">
      <div class="field">
        <label for="dob">Date of birth</label>
        <input type="date" id="dob" />
      </div>

      <div class="field">
        <label>Experience</label>
        <div class="radioRow">
          <label><input type="radio" name="experience" value="compact" checked> Compact</label>
          <label><input type="radio" name="experience" value="complete"> Complete</label>
        </div>
        <p class="micro">Compact hides extra panels. Complete shows everything.</p>
      </div>

      <div class="field">
        <label>Day boundary mode</label>
        <div class="radioRow">
          <label><input type="radio" name="mode" value="utc" checked> UTC-safe</label>
          <label><input type="radio" name="mode" value="local"> Local midnight</label>
        </div>
      </div>

      <div class="field">
        <label for="density">Guidance density</label>
        <select id="density">
          <option value="minimal">Minimal</option>
          <option value="supportive">Supportive</option>
          <option value="silent">Silent</option>
        </select>
      </div>

      <div class="field">
        <label>Label style</label>
        <div class="radioRow">
          <label><input type="radio" name="gentle" value="on" checked> Gentle (“Not marked”)</label>
          <label><input type="radio" name="gentle" value="off"> Direct (“Not done”)</label>
        </div>
      </div>

      <div class="field">
        <button class="btn" id="clearCycleBtn" type="button">Clear current cycle data</button>
      </div>
    </div>
  </dialog>

  <!-- Review dialog -->
  <dialog id="reviewDialog" aria-labelledby="reviewTitle">
    <div class="dialogHead">
      <h2 id="reviewTitle">Review your notes</h2>
      <button class="topBtn" id="closeReview" type="button">Close</button>
    </div>

    <div class="dialogBody">
      <div class="field">
        <label for="reviewQuery">Search</label>
        <input id="reviewQuery" type="text" placeholder="Search your notes..." />
      </div>

      <div class="field">
        <div class="radioRow">
          <label><input type="radio" name="reviewScope" value="cycle" checked> This cycle</label>
          <label><input type="radio" name="reviewScope" value="all"> All time</label>
        </div>
      </div>

      <div class="field" style="display:flex; gap:10px; flex-wrap:wrap;">
        <button class="btn" id="exportNotesTxtBtn" type="button">Export notes (TXT)</button>
      </div>

      <div class="field">
        <div class="noteList" id="noteList" aria-label="Notes list"></div>
      </div>

      <div class="field" id="reviewEditorWrap" hidden>
        <label for="reviewEditor">Edit selected note</label>
        <textarea id="reviewEditor" rows="8" placeholder="Edit note..."></textarea>

        <div class="noteFooter">
          <div class="live" aria-live="polite">
            <span class="mark" aria-hidden="true"></span>
            <span id="reviewSaveText">Autosave enabled</span>
          </div>
          <div class="controls">
            <button class="btn" id="jumpToTodayBtn" type="button">Jump to today</button>
          </div>
        </div>
      </div>
    </div>
  </dialog>

  <div class="toast" id="toast" role="status" aria-live="polite">Saved</div>

  <script src="./assets/app.js" defer></script>

  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./service-worker.js").catch(() => { });
      });
    }
  </script>
</body>

</html>