<!DOCTYPE html>
<html data-experience="compact" data-layout="mobile" lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width,initial-scale=1" name="viewport"/>
  <title>
   Cosmic 36 &mdash; Today
  </title>
  <!-- PWA -->
  <link href="./manifest.webmanifest" rel="manifest"/>
  <meta content="#0b0b0f" media="(prefers-color-scheme: dark)" name="theme-color"/>
  <meta content="#ffffff" media="(prefers-color-scheme: light)" name="theme-color"/>
  <meta content="yes" name="apple-mobile-web-app-capable"/>
  <meta content="yes" name="mobile-web-app-capable"/>
  <meta content="Cosmic 36" name="apple-mobile-web-app-title"/>
  <meta content="179413367660-jl93spt8ndl02mf1ilna007mt7sedou5.apps.googleusercontent.com" name="google-client-id"/>
  <link href="./icons/icon-192.png" rel="apple-touch-icon"/>
  <link href="./icons/icon.svg" rel="icon" type="image/svg+xml"/>
  <link href="./icons/icon-192.png" rel="icon" sizes="192x192" type="image/png"/>
  <link href="./assets/style.css" rel="stylesheet">
  </link>
  <script defer src="https://accounts.google.com/gsi/client"></script>
 </head>
 <body>
  <div aria-hidden="true" class="aura">
  </div>
  <header class="container appHeader">
   <div class="brand">
    <h1>
     Cosmic 36 &mdash; Today
    </h1>
    <p id="subLine">
     One screen. One day. One note.
    </p>
   </div>
   <nav aria-label="App actions" class="headerActions">
    <button class="topBtn" id="layoutBtn" type="button">
     Desktop view
    </button>
    <button aria-controls="reviewDialog" aria-expanded="false" aria-haspopup="dialog" class="topBtn" id="openReview" type="button">
     Review notes
    </button>
    <button aria-controls="settingsDialog" aria-expanded="false" aria-haspopup="dialog" class="topBtn" id="openSettings" type="button">
     Settings
    </button>
   </nav>
  </header>
  <main class="container">
   <article aria-label="Today overview" class="card">
    <header class="cardHeader">
     <h2 id="headerTitle">
      Day &mdash; / 36
     </h2>
     <p id="headerPhase">
      Open Settings and enter your date of birth.
     </p>
     <div aria-label="Today badges" class="chips" id="chipRow">
     </div>
     <!-- Pattern start callout row -->
     <div aria-label="Pattern start row" class="patternRow">
      <div class="patternChipWrap">
       <div class="patternChip" id="patternLine">
       </div>
       <button aria-label="Pattern info" class="miniInfoBtn" id="patternInfoBtn" type="button">
        ⓘ
       </button>
      </div>
     </div>
    </header>
    <!-- PROGRESS (36 days) -->
    <section aria-label="Cycle progress" class="progressSection">
     <div class="progressHead">
      <div class="progressTitle">
       Cycle progress
      </div>
      <div class="progressMeta" hidden="" id="reminderMeta">
      </div>
     </div>
     <div aria-label="Cycle day buttons" class="progressBar" id="progressBar" role="navigation">
     </div>
     <div aria-hidden="true" class="progressLegend">
      <span class="legendItem">
       <span class="legendDot anchor">
       </span>
       Anchor
      </span>
      <span class="legendItem">
       <span class="legendDot echo">
       </span>
       Echo
      </span>
      <span class="legendItem">
       <span class="legendDot light">
       </span>
       Light
      </span>
      <span class="legendItem">
       <span class="legendDot done">
       </span>
       Marked
      </span>
     </div>
    </section>
    <div class="cardBody">
     <div class="layout">
      <!-- LEFT -->
      <section aria-label="Today guidance and writing">
       <section aria-label="Today guidance" class="today light" id="todayCard">
        <header class="todayTop">
         <h3 id="bigDay">
          Day &mdash;
          <small>
           / 36
          </small>
         </h3>
         <button aria-pressed="false" class="stateBtn" id="statusBtn" type="button">
          <span aria-hidden="true" class="stateDot" id="stateDot">
          </span>
          <span id="statusText">
           Not marked
          </span>
         </button>
        </header>
        <p class="guidance" id="guidanceLine">
         &mdash;
        </p>
        <p class="hint" id="hintLine">
         &mdash;
        </p>
        <!-- Minimal guidance = insight box stays hidden unless Supportive density -->
        <aside aria-label="Spiritual insight" class="insight" hidden="" id="insightBox">
         <h4>
          Spiritual insight for today
         </h4>
         <p id="insightLine">
          &mdash;
         </p>
        </aside>
        <p class="swipeHint" id="swipeHint">
         <span>
          <b>
           Swipe right
          </b>
          to mark
         </span>
         <span>
          <b>
           Swipe left
          </b>
          to unmark
         </span>
        </p>
       </section>
       <hr class="sep"/>
       <section aria-label="Daily note">
        <label class="noteLabel" for="noteBox" id="notePrompt">
         Mindful note
        </label>
        <textarea id="noteBox" placeholder="What did I do? What did I notice? What will I carry forward?" rows="6"></textarea>
        <div class="noteFooter">
         <div aria-live="polite" class="live" id="saveStatus">
          <span aria-hidden="true" class="mark">
          </span>
          <span id="saveText">
           Autosave enabled
          </span>
         </div>
         <div class="controls">
          <button aria-expanded="false" class="btn" id="expandBtn" type="button">
           Expand
          </button>
          <button class="btn" id="insertTemplateBtn" type="button">
           Insert template
          </button>
          <button class="btn" id="clearNoteBtn" type="button">
           Clear
          </button>
         </div>
        </div>
       </section>
       <!-- COMPLETE WRITING (collapsible) -->
       <section aria-label="Complete writing sections" hidden="" id="extrasWrap">
        <div class="sectionTitle">
         Complete sections
        </div>
        <!-- INTENTION -->
        <details class="collapse" id="detailsIntention">
         <summary class="collapseSummary">
          <span class="collapseTitle">
           Intention (morning) &mdash; what I will repeat + observe
          </span>
          <span class="collapseMeta muted" id="intentionMeta">
           Optional
          </span>
         </summary>
         <div class="collapseBody">
          <label class="noteLabel" for="intentionBox">
           Intention
          </label>
          <textarea id="intentionBox" placeholder="One line intention..." rows="4"></textarea>
          <div class="noteFooter">
           <div aria-live="polite" class="live">
            <span aria-hidden="true" class="mark">
            </span>
            <span id="intentionSaveText">
             Autosave enabled
            </span>
           </div>
          </div>
         </div>
        </details>
        <!-- REFLECTION -->
        <details class="collapse" id="detailsReflection">
         <summary class="collapseSummary">
          <span class="collapseTitle">
           Reflection (evening) &mdash; what returned + meaning
          </span>
          <span class="collapseMeta muted" id="reflectionMeta">
           Optional
          </span>
         </summary>
         <div class="collapseBody">
          <label class="noteLabel" for="reflectionBox">
           Reflection
          </label>
          <textarea id="reflectionBox" placeholder="What returned? What did I notice?" rows="5"></textarea>
          <div class="noteFooter">
           <div aria-live="polite" class="live">
            <span aria-hidden="true" class="mark">
            </span>
            <span id="reflectionSaveText">
             Autosave enabled
            </span>
           </div>
          </div>
         </div>
        </details>
        <!-- CLOSE THE CYCLE -->
        <details class="collapse" id="detailsClose">
         <summary class="collapseSummary">
          <span class="collapseTitle">
           Close the cycle
          </span>
          <span class="collapseMeta muted">
           Optional
          </span>
         </summary>
         <div class="collapseBody">
          <p class="tiny">
           Capture the lesson and carry the clean signal forward.
          </p>
          <label class="noteLabel" for="cycleLessonBox">
           What did this cycle teach me?
          </label>
          <textarea id="cycleLessonBox" placeholder="One honest lesson..." rows="4"></textarea>
          <label class="noteLabel" for="cycleCarryBox">
           What stays (what I carry forward)?
          </label>
          <textarea id="cycleCarryBox" placeholder="One commitment..." rows="4"></textarea>
          <label class="noteLabel" for="cycleReleaseBox">
           What leaves (what I release)?
          </label>
          <textarea id="cycleReleaseBox" placeholder="One thing I stop feeding..." rows="4"></textarea>
          <div class="noteFooter">
           <div aria-live="polite" class="live">
            <span aria-hidden="true" class="mark">
            </span>
            <span id="cycleSaveText">
             Autosave enabled
            </span>
           </div>
          </div>
         </div>
        </details>
       </section>
      </section>
      <!-- RIGHT (Desktop aside) -->
      <aside aria-label="Life snapshot" class="asideCard" hidden="" id="lifeAside">
       <h2>
        Life on Earth
       </h2>
       <p id="asideText">
        &mdash;
       </p>
       <div class="kv" id="kv">
       </div>
       <div class="asideQuick">
        <button class="btn" id="asideReviewBtn" type="button">
         Review notes
        </button>
        <button class="btn" id="asideSettingsBtn" type="button">
         Settings
        </button>
       </div>
      </aside>
     </div>
    </div>
   </article>
  </main>
  <footer class="container appFooter">
   &copy;
   <span id="yearNow">
   </span>
   <a class="footerLink" href="https://paske-style.com" rel="noopener" target="_blank">
    Paske STYLE
   </a>
   <br/>
   Cosmic 36
  </footer>
  <!-- SETTINGS -->
  <dialog aria-labelledby="settingsTitle" id="settingsDialog">
   <div class="dialogHead">
    <h2 id="settingsTitle">
     Settings
    </h2>
    <button class="topBtn" id="closeSettings" type="button">
     Close
    </button>
   </div>
   <div class="dialogBody">
    <!-- Identity -->
    <section aria-label="Identity" class="settingsGroup">
     <div class="settingsGroupTitle">
      Identity
     </div>
     <div class="field">
      <label for="dob">
       Date of birth
      </label>
      <input id="dob" type="date"/>
      <div class="tiny">
       Used to calculate your 36-day cycle on this device.
      </div>
     </div>
    </section>
    <!-- Daily rhythm -->
    <section aria-label="Daily rhythm" class="settingsGroup">
     <div class="settingsGroupTitle">
      Daily rhythm
     </div>
     <div class="field">
      <label>
       Day boundary
      </label>
      <div class="radioRow">
       <label>
        <input checked="" name="mode" type="radio" value="utc"/>
        Stable day (recommended)
       </label>
       <label>
        <input name="mode" type="radio" value="local"/>
        Local midnight
       </label>
      </div>
      <div class="tiny">
       Stable day won&rsquo;t shift when you travel. Local midnight changes with your current timezone.
      </div>
     </div>
    </section>
    <!-- Writing experience -->
    <section aria-label="Writing experience" class="settingsGroup">
     <div class="settingsGroupTitle">
      Writing experience
     </div>
     <div class="field">
      <label for="density">
       Guidance density
      </label>
      <select id="density">
       <option value="minimal">
        Minimal
       </option>
       <option value="supportive">
        Supportive
       </option>
       <option value="silent">
        Silent
       </option>
      </select>
     </div>
     <div class="field">
      <label>
       Experience
      </label>
      <div class="radioRow">
       <label>
        <input name="experience" type="radio" value="compact"/>
        Compact
       </label>
       <label>
        <input name="experience" type="radio" value="complete"/>
        Complete
       </label>
      </div>
      <div class="tiny">
       Compact hides extra writing sections. Complete shows Intention, Reflection, and Close the cycle.
      </div>
     </div>
     <div class="field">
      <label>
       Marking style
      </label>
      <div class="radioRow">
       <label>
        <input checked="" name="gentle" type="radio" value="on"/>
        Gentle (Marked / Not marked)
       </label>
       <label>
        <input name="gentle" type="radio" value="off"/>
        Direct (Done / Not done)
       </label>
      </div>
      <div class="tiny">
       This changes wording only &mdash; your data stays the same.
      </div>
     </div>
    </section>
    <!-- Reminders -->
    <section aria-label="Reminders" class="settingsGroup">
     <div class="settingsGroupTitle">
      Reminders
     </div>
     <div class="field">
      <label class="check">
       <input id="reminderEnabled" type="checkbox"/>
       Enable reminders
      </label>
      <div class="reminderControls">
       <select aria-label="Reminder days" id="reminderKinds">
        <option value="anchor_echo">
         Anchor + Echo
        </option>
        <option value="anchor">
         Anchor only
        </option>
        <option value="echo">
         Echo only
        </option>
       </select>
       <input aria-label="Reminder time" id="reminderTime" type="time" value="09:00"/>
      </div>
      <div class="tiny" id="nextReminderText">
       Next reminder: &mdash;
      </div>
     </div>
     <div class="field notifRow">
      <div class="notifInfo">
       <div class="notifStatusPill" id="notifStatusPill">
        <span aria-hidden="true" class="pillDot">
        </span>
        <span id="notifStatus">
         Notifications are optional &mdash; reminders still appear inside the app.
        </span>
       </div>
       <div class="notifMeta">
        <div class="tiny" id="notifAppStatus">
         App setting: Off
        </div>
        <div class="tiny" id="notifPermStatus">
         Browser permission: Not asked
        </div>
        <div class="tiny" hidden="" id="notifHelp">
         Allow notifications in browser settings to enable.
        </div>
       </div>
      </div>
      <div class="notifControls">
       <label class="switch">
        <input id="notifToggle" type="checkbox"/>
        <span aria-hidden="true" class="switchTrack">
        </span>
        <span class="switchText">
         Notifications
        </span>
       </label>
       <button class="btn" id="testNotifBtn" type="button">
        Test notification
       </button>
      </div>
     </div>
     <div class="tiny">
      Turning off keeps reminders inside the app. Push notifications work best when the app is installed (Add to Home Screen).
     </div>
    </section>
    <!-- Cloud backup -->
    <section aria-label="Cloud backup" class="settingsGroup">
     <div class="settingsGroupTitle">
      Cloud backup
     </div>
     <div class="field">
      <div class="tiny">
       Sign in with Google to save a private backup in your Drive app data folder.
      </div>
     </div>
     <div class="field">
      <div class="backupRow">
       <button class="btn" id="googleSignInBtn" type="button">
        Connect Google
       </button>
       <button class="btn" hidden="" id="googleSignOutBtn" type="button">
        Sign out
       </button>
      </div>
      <div class="tiny" id="googleStatus">
       Not connected.
      </div>
     </div>
     <div class="field">
     <div class="backupRow">
       <button class="btn" disabled="" id="backupNowBtn" type="button">
        Backup now
       </button>
       <button class="btn" disabled="" id="restoreNowBtn" type="button">
        Restore backup
       </button>
       <button class="btn dangerBtn" disabled="" id="deleteBackupBtn" type="button">
        Delete backup
       </button>
     </div>
      <label class="check">
       <input id="autoBackupEnabled" type="checkbox"/>
       Auto-backup when notes change
      </label>
      <div class="tiny warningText">
       Warning: If auto-backup is on, clearing the current cycle will back up the cleared notes.
      </div>
      <div class="tiny" id="backupMeta">
       Last backup: Never. Last restore: Never.
      </div>
     </div>
    </section>
    <!-- Advanced / Danger zone -->
    <section aria-label="Advanced" class="settingsGroup dangerZone">
     <div class="settingsGroupTitle">
      Advanced
     </div>
     <div class="field">
      <button class="btn dangerBtn" id="clearCycleBtn" type="button">
       Clear current cycle data
      </button>
      <div class="tiny">
       Deletes notes + marks for the current cycle on this device only.
      </div>
     </div>
    </section>
   </div>
  </dialog>
  <!-- DELETE BACKUP -->
  <dialog aria-describedby="deleteBackupMessage" aria-labelledby="deleteBackupTitle" id="deleteBackupDialog">
   <div class="dialogHead">
    <h2 id="deleteBackupTitle">
     Delete cloud backup
    </h2>
    <button class="topBtn" id="deleteBackupCancel" type="button">
     Cancel
    </button>
   </div>
   <div class="dialogBody">
    <div class="field">
     <p id="deleteBackupMessage">
      This permanently deletes the backup stored in your Google Drive app data.
     </p>
    </div>
    <div class="controls">
     <button class="btn dangerBtn" id="deleteBackupConfirm" type="button">
      Delete backup
     </button>
    </div>
   </div>
  </dialog>
  <!-- CLEAR NOTE -->
  <dialog aria-describedby="clearNoteMessage" aria-labelledby="clearNoteTitle" id="clearNoteDialog">
   <div class="dialogHead">
    <h2 id="clearNoteTitle">
     Clear today's note
    </h2>
    <button class="topBtn" id="clearNoteCancel" type="button">
     Cancel
    </button>
   </div>
   <div class="dialogBody">
    <div class="field">
     <p id="clearNoteMessage">
      This will remove the note for today.
     </p>
    </div>
    <div class="controls">
     <button class="btn dangerBtn" id="clearNoteConfirm" type="button">
      Clear note
     </button>
    </div>
   </div>
  </dialog>
  <!-- REVIEW -->
  <dialog aria-labelledby="reviewTitle" id="reviewDialog">
   <div class="dialogHead">
    <h2 id="reviewTitle">
     Review your notes
    </h2>
    <button class="topBtn" id="closeReview" type="button">
     Close
    </button>
   </div>
   <div class="dialogBody">
    <div class="field">
     <label for="reviewQuery">
      Search
     </label>
     <input id="reviewQuery" placeholder="Search your notes..." type="text">
     </input>
    </div>
    <div class="field">
     <div class="radioRow">
      <label>
       <input checked="" name="reviewScope" type="radio" value="cycle"/>
       This cycle
      </label>
      <label>
       <input name="reviewScope" type="radio" value="all"/>
       All time
      </label>
     </div>
    </div>
    <div class="field" id="reviewFilterField">
     <label>
      Filter
     </label>
     <div class="radioRow">
      <label>
       <input checked="" id="reviewFilterDaily" type="checkbox"/>
       Daily notes
      </label>
      <label>
       <input checked="" id="reviewFilterExtra" type="checkbox"/>
       Additional notes
      </label>
      <label>
       <input checked="" id="reviewFilterCycle" type="checkbox"/>
       Cycle notes
      </label>
     </div>
    </div>
    <!-- EXPORTS MOVED HERE -->
    <div class="field" style="display:flex; gap:10px; flex-wrap:wrap;">
     <button class="btn" id="exportNotesTxtBtn" type="button">
      Export notes (TXT)
     </button>
     <button class="btn" id="exportCloseTxtBtn" type="button">
      Export closing notes (TXT)
     </button>
     <button class="btn" id="exportBothTxtBtn" type="button">
      Export notes + closing (TXT)
     </button>
    </div>
    <div class="field">
     <div aria-label="Notes list" class="noteList" id="noteList">
     </div>
    </div>
    <div class="field" hidden="" id="reviewEditorWrap">
     <label for="reviewEditor">
      Edit selected note
     </label>
     <textarea id="reviewEditor" placeholder="Edit note..." rows="8"></textarea>
     <div class="noteFooter">
      <div aria-live="polite" class="live">
       <span aria-hidden="true" class="mark">
       </span>
       <span id="reviewSaveText">
        Autosave enabled
       </span>
      </div>
      <div class="controls">
       <button class="btn" id="jumpToTodayBtn" type="button">
        Jump to today
       </button>
      </div>
     </div>
    </div>
   </div>
  </dialog>
  <!-- CONFIRM -->
  <dialog aria-describedby="confirmMessage" aria-labelledby="confirmTitle" id="confirmDialog">
   <div class="dialogHead">
    <h2 id="confirmTitle">
     Confirm
    </h2>
    <button class="topBtn" id="confirmCancel" type="button">
     Cancel
    </button>
   </div>
   <div class="dialogBody">
    <div class="field">
     <p id="confirmMessage">
     </p>
    </div>
    <div class="controls">
     <button class="btn" id="confirmOk" type="button">
      OK
     </button>
    </div>
   </div>
  </dialog>
  <!-- INFO -->
  <dialog aria-describedby="infoMessage" aria-labelledby="infoTitle" id="infoDialog">
   <div class="dialogHead">
    <h2 id="infoTitle">
     Notice
    </h2>
    <button class="topBtn" id="infoClose" type="button">
     Close
    </button>
   </div>
   <div class="dialogBody">
    <div class="field">
     <p id="infoMessage">
     </p>
    </div>
   </div>
  </dialog>
  <div aria-live="polite" class="toast" id="toast" popover="manual" role="status">
   <span aria-hidden="true" class="toastIcon">
    ⓘ
   </span>
   <span class="toastText">
    Saved
   </span>
  </div>
  <script src="./assets/app.js" type="module">
  </script>
  <script>
   if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./service-worker.js").catch(() => { });
      });
    }
  </script>
 </body>
</html>
